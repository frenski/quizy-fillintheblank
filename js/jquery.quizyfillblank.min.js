Array.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1}),function(e){e.fn.quizyFillBlank=function(t){var a,n=e.extend({},e.fn.quizyFillBlank.defaults,t),r=n.textItems,d=n.anItemsCorrect,i=n.anItems,l=i.length,s=d.length,o=0,c=0,h=0,p=!1,f=e("#"+n.elementAnId),u=e("#"+n.elementTextId),b={},g={};var m=function(){c++};function I(e,t,a,n){e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on"+t,a)}function v(t){var a=t.changedTouches[0],n="";switch(t.type){case"touchstart":n="mousedown";break;case"touchmove":n="mousemove";break;case"touchend":n="mouseup";break;default:return}var r=document.createEvent("MouseEvent");r.initMouseEvent(n,!0,!0,window,1,a.screenX,a.screenY,a.clientX,a.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(r),(e(t.target).hasClass("draggable-element")||e(t.target).parent().hasClass("draggable-element"))&&t.preventDefault()}n.allowTouchDrag&&(I(document,"touchstart",v,!0),I(document,"touchmove",v,!0),I(document,"touchend",v,!0),I(document,"touchcancel",v,!0));for(var y=0;y<s;y++)if(u.append("<span>"+r[y]+'</span> <span id="'+n.phId+y+'" style="width:'+n.blockSize+"px; height:"+n.blockSizeHeight+'px; " class="droppable-element quizy-fitb-droptarget"></span>'),y==s-1){var k=y+1;u.append("<span>"+r[k]+"</span>")}var z=f;for(y=0;y<l;y++)z.append('<div id="'+n.answerId+y+'" class="quizy-fitb-answer draggable-element quizy-fitb-dropelement" style="width:'+n.blockSize+"px; height: "+n.blockSizeHeight+'px;">'+i[y]+"</div>"),e("#"+n.answerId+y).append('<div id="'+n.checkId+y+'" class="quizy-fitb-res quizy-fitb-res-no '+n.checkId+'">x</div>'),e("#"+n.answerId+y).append('<div id="'+n.numberId+y+'" class="quizy-fitb-res quizy-fitb-res-num '+n.checkId+'">'+(parseInt(d.indexOf(y))+1)+"</div>");e(".draggable-element").draggable({cursor:"move",containment:"document",stop:function(e,t){parseInt(t.offset.left),parseInt(t.offset.top)},start:function(t,a){var n=parseInt(a.offset.left),r=parseInt(a.offset.top);b[e(this).attr("id")]={top:r,left:n}},revert:!0}),e(".draggable-element").on("click",(function(t){!function(t,a){if(a.draggable("option","disabled")){var r=a.attr("id"),i=r.substring(n.answerId.length,r.length),l=g[i],s=e("#"+n.phId+l);a.draggable("enable"),a.draggable("option","revert",!0),a.removeClass("quizy-fitb-dropelement-disabled"),a.offset(b[a.attr("id")]),s.droppable("enable"),o--,d[l]==i&&(e("#"+n.checkId+i).addClass("quizy-fitb-res-no").removeClass("quizy-fitb-res-yes"),e("#"+n.checkId+i).html("x"),h--)}}(0,e(this))})),e(".droppable-element").droppable({drop:function(t,r){var i=e(this);i.droppable("disable"),r.draggable.addClass("quizy-fitb-dropelement-disabled"),r.draggable.draggable("disable"),r.draggable.position({of:e(this),my:"left top",at:"left top"}),r.draggable.draggable("option","revert",!1);var l=i.attr("id"),f=l.substring(n.phId.length,l.length),u=(l=r.draggable.attr("id")).substring(n.answerId.length,l.length);d[f]==u&&(e("#"+n.checkId+u).removeClass("quizy-fitb-res-no").addClass("quizy-fitb-res-yes"),e("#"+n.checkId+u).html("&#10003"),h++),g[u]=f,p||(a=setInterval(m,1e3),p=!0),++o==s&&(clearInterval(a),e("."+n.checkId).fadeIn(),e("."+n.numberId).fadeIn(),""!=n.onFinishCall&&n.onFinishCall({correct_answers:h,all_answers:s,time:c}),e(".draggable-element").off("click"))},hoverClass:"quizy-fitb-droptarget-hover"});for(y=0;y<l;y++)e("#"+n.checkId+y).position({of:e("#"+n.answerId+y),my:"right center ",at:"right center",offset:"0 5px"}),e("#"+n.numberId+y).position({of:e("#"+n.answerId+y),my:"right center",at:"right center",offset:"10px -10px"}),e("#"+n.checkId+y).hide(),e("#"+n.numberId+y).hide();""!=n.onLoadCall&&n.onLoadCall()},e.fn.quizyFillBlank.defaults={elementAnId:"fillblank-ph",textItems:["Text part1","text part 2","text part 3"],elementTextId:"fillblank-text",anItems:["an1","an2","an3"],anItemsCorrect:[2,0],answerId:"d-answer",phId:"d-nest",checkId:"d-check",numberId:"d-number",blockSize:100,blockSizeHeight:20,onFinishCall:"",onLoadCall:"",allowTouchDrag:!0}}(jQuery);
