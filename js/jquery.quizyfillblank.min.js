Array.indexOf||(Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1}),function(e){e.fn.quizyFillBlank=function(t){var n,a=e.extend({},e.fn.quizyFillBlank.defaults,t),r=a.textItems,d=a.anItemsCorrect,s=a.anItems,l=s.length,i=d.length,o=0,c=0,u=0,p=e("#"+a.elementAnId),h=e("#"+a.elementTextId),f="";for(I=0;I<Math.round(a.blockSize/10);I++)f+="_";var b=function(){c++};function g(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on"+t,n)}function m(t){var n=t.changedTouches[0],a="";switch(t.type){case"touchstart":a="mousedown";break;case"touchmove":a="mousemove";break;case"touchend":a="mouseup";break;default:return}var r=document.createEvent("MouseEvent");r.initMouseEvent(a,!0,!0,window,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(r),(e(t.target).hasClass("draggable-element")||e(t.target).parent().hasClass("draggable-element"))&&t.preventDefault()}a.allowTouchDrag&&(g(document,"touchstart",m,!0),g(document,"touchmove",m,!0),g(document,"touchend",m,!0),g(document,"touchcancel",m,!0));for(var I=0;I<i;I++)if(h.append("<span>"+r[I]+'</span> <span id="'+a.phId+I+'" class="droppable-element quizy-fitb-droptarget">'+f+"</span> "),I==i-1){var v=I+1;h.append("<span>"+r[v]+"</span>")}var y=p;for(I=0;I<l;I++)y.append('<div id="'+a.answerId+I+'" class="quizy-fitb-answer draggable-element quizy-fitb-dropelement" style="width:'+a.blockSize+'px">'+s[I]+"</div>"),e("#"+a.answerId+I).append('<div id="'+a.checkId+I+'" class="quizy-fitb-res quizy-fitb-res-no '+a.checkId+'">x</div>'),e("#"+a.answerId+I).append('<div id="'+a.numberId+I+'" class="quizy-fitb-res quizy-fitb-res-num '+a.checkId+'">'+(parseInt(d.indexOf(I))+1)+"</div>");e(".draggable-element").draggable({cursor:"move",containment:"document",stop:function(e,t){parseInt(t.offset.left),parseInt(t.offset.top)},revert:!0}),e(".droppable-element").droppable({drop:function(t,r){e(this).droppable("disable"),r.draggable.addClass("quizy-fitb-dropelement-disabled"),r.draggable.draggable("disable"),r.draggable.position({of:e(this),my:"left top",at:"left top"}),r.draggable.draggable("option","revert",!1);var s=e(this).attr("id"),l=s.substring(a.phId.length,s.length),p=(s=r.draggable.attr("id")).substring(a.answerId.length,s.length);d[l]==p&&(e("#"+a.checkId+p).removeClass("quizy-fitb-res-no").addClass("quizy-fitb-res-yes"),e("#"+a.checkId+p).html("&#10003"),u++),0==o&&(n=setInterval(b,1e3)),++o==i&&(clearInterval(n),e("."+a.checkId).fadeIn(),e("."+a.numberId).fadeIn(),""!=a.onFinishCall&&a.onFinishCall({correct_answers:u,all_answers:i,time:c}))},hoverClass:"quizy-fitb-droptarget-hover"});for(I=0;I<l;I++)e("#"+a.checkId+I).position({of:e("#"+a.answerId+I),my:"right center ",at:"right center",offset:"0 5px"}),e("#"+a.numberId+I).position({of:e("#"+a.answerId+I),my:"right center",at:"right center",offset:"10px -10px"}),e("#"+a.checkId+I).hide(),e("#"+a.numberId+I).hide();""!=a.onLoadCall&&a.onLoadCall()},e.fn.quizyFillBlank.defaults={elementAnId:"fillblank-ph",textItems:["Text part1","text part 2","text part 3"],elementTextId:"fillblank-text",anItems:["an1","an2","an3"],anItemsCorrect:[2,0],answerId:"d-answer",phId:"d-nest",checkId:"d-check",numberId:"d-number",blockSize:100,onFinishCall:"",onLoadCall:"",allowTouchDrag:!0}}(jQuery);
